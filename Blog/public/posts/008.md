Git Flow est un modèle de workflow qui structure le développement sur le long terme en séparant clairement les différentes phases : développement, préparation de release, correctifs urgents et production. L'objectif est de maintenir un projet organisé, lisible et sûr, même lorsque plusieurs développeurs collaborent.

Dans Git Flow, chaque type de branche a un rôle précis :

| Branche | Rôle  |
| ----------- | ------------------------------------------------------ |
| `main` | Représente la version stable en production. Tout ce qui y est fusionné doit être prêt à être déployé. |
| `develop` | Intégration des nouvelles fonctionnalités. Cette branche sert de base pour toutes les releases futures. |
| `feature/*` | Chaque nouvelle fonctionnalité se développe sur une branche `feature` issue de `develop`. |
| `release/*` | Branches temporaires pour préparer une version à publier. Elles permettent de stabiliser le code, corriger des bugs et mettre à jour la documentation. Elles partent de `develop` et sont fusionnées à la fois dans `main` et `develop`. |
| `hotfix/*` | Branches pour corriger rapidement un bug en production. Elles partent de `release` et sont fusionnées à la fois dans `main` et `develop`. |

L'avantage principal de Git Flow est la clarté du cycle de vie d'une version. Les développeurs savent exactement où travailler selon le type de tâche, et la production reste protégée des changements instables. Le principal inconvénient est que le workflow peut paraître lourd pour de petits projets ou des équipes très agiles, mais il reste idéal pour comprendre un processus structuré et industriel.

## Cycle de release
Imaginons que votre dépôt est prêt à publier une version 2025.001.000. Le workflow typique avec Git Flow se déroule ainsi :

### Créer une branche de release
Partir de develop pour préparer la version :
``` bash
git checkout develop
git checkout -b release/2026.001.000 # premiére release de janvier 2026
```

Sur cette branche, on stabilise le code :

- Correction de bugs critiques
- Nouvelles fonctionalités
- Mise à jour de la documentation et des notes de version

Aprés la création de la branche release, aucune nouvelle fonctionnalité ne peut être ajoutée, *seules des corrections sont acceptées.*

### Initialiser Git Flow
``` bash
git flow init
```
Git Flow nous pose quelques questions :
- Nom de la branche de production (main ou master)
- Nom de la branche de développement (develop)
- Préfixes pour les branches feature/, release/, hotfix/ et support/


``` bash
$ git flow init

Initialized empty Git repository in ~/project/.git/
No branches exist yet. Base branches must be created now.
Branch name for production releases: [main]
Branch name for "next release" development: [develop]

How to name your supporting branch prefixes?
Feature branches? [feature/]
Release branches? [release/]
Hotfix branches? [hotfix/]
Support branches? [support/]
Version tag prefix? []

$ git branch
* develop
 main
```

Après cette étape, le dépôt est prêt à utiliser les commandes Git Flow.

### Préparer les branches avant la release
Avant de démarrer la release, il est recommandé de mettre toutes les branches à jour et de réécrire leur historique si nécessaire pour éviter les conflits ou un graphe trop ramifié. Les étapes typiques sont :

``` bash
git fetch
git checkout develop
git rebase -i develop
git checkout release
git rebase -i release
git checkout main
git rebase -i main
``` 

Après ces rebases, toutes les branches concernées sont prêtes. Il est maintenant sûr de lancer la release avec Git Flow.

### Terminer la release

Quand la release est prête :

``` bash
git flow release finish '2025.001.000'
```

Ce que fait cette commande automatiquement :
1. Merge `release/2025.001.000` dans main
2. Merge `release/2025.001.000` dans develop
3. Crée un tag automatique `v2025.001.000` sur la branche main
4. Supprime la branche `release/2025.001.000` locale

## Références
- [Gitflow workflow](https://www.atlassian.com/git/tutorials/comparing-workflows/gitflow-workflow)